"use strict";(self.webpackChunkenglish_flashcards=self.webpackChunkenglish_flashcards||[]).push([[774],{774:(t,e,s)=>{s.r(e),s.d(e,{default:()=>R});var r=s(5043),n=s(2555),i=s(9781),o=s(2836),a=s(5207),u=s(4834);const c="\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f",l="\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0430\u043d\u0433\u043b\u0438\u0439\u0441\u043a\u0438\u0435 \u0431\u0443\u043a\u0432\u044b, \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0434\u0435\u0444\u0438\u0441\u044b \u0438 \u0430\u043f\u043e\u0441\u0442\u0440\u043e\u0444\u044b",d="\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u044b \u0442\u0440\u0430\u043d\u0441\u043a\u0440\u0438\u043f\u0446\u0438\u0438",h="\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0440\u0443\u0441\u0441\u043a\u0438\u0435 \u0431\u0443\u043a\u0432\u044b, \u043f\u0440\u043e\u0431\u0435\u043b\u044b \u0438 \u0434\u0435\u0444\u0438\u0441\u044b",p=t=>"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 ".concat(t," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),m=t=>"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 ".concat(t," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),f={ENGLISH_WORD:/^[A-Za-z\s'-]+$/,TRANSCRIPTION:/^[a-zA-Z\u0250-\u02AF\u02C8\u02CC\u02D0\s'\u02d0\u02c8\u02cc]+$/,RUSSIAN_WORD:/^[\u0410-\u042f\u0430-\u044f\u0401\u0451\s-]+$/},b={required:t=>t&&t.trim()?null:c,englishWord:t=>t&&t.trim()&&!f.ENGLISH_WORD.test(t)?l:null,transcription:t=>{if(!t||!t.trim())return null;const e=t.replace(/\[|\]/g,"");return f.TRANSCRIPTION.test(e)?null:d},russianWord:t=>t&&t.trim()&&!f.RUSSIAN_WORD.test(t)?h:null,minLength:t=>e=>!e||!e.trim()||e.length>=t?null:p(t),maxLength:t=>e=>!e||!e.trim()||e.length<=t?null:m(t)};const g={form:"AddWordForm_form__3YoZc",field:"AddWordForm_field__CR9-8",input:"AddWordForm_input__GQ-nM",errorInput:"AddWordForm_errorInput__4f3O7",caption:"AddWordForm_caption__Ybb5y",asterisk:"AddWordForm_asterisk__D6XWX",button:"AddWordForm_button__eQWs4",buttonInactive:"AddWordForm_buttonInactive__EVScR",success:"AddWordForm_success__oroQ-",error:"AddWordForm_error__5DqMM"};var _=s(579);const S={english:{label:"\u0421\u043b\u043e\u0432\u043e (\u0430\u043d\u0433\u043b.)",rules:["required","englishWord"]},transcription:{label:"\u0422\u0440\u0430\u043d\u0441\u043a\u0440\u0438\u043f\u0446\u0438\u044f",rules:["required","transcription"]},russian:{label:"\u041f\u0435\u0440\u0435\u0432\u043e\u0434",rules:["required","russianWord"]},tags:{label:"\u0422\u0435\u043c\u0430",rules:[]}};function W(){const t=(0,i.jE)(),[e,s,c]=function(t){const[e,s]=(0,r.useState)(t);return[e,t=>{const{name:e,value:r}=t.target;s(t=>(0,n.A)((0,n.A)({},t),{},{[e]:r}))},()=>s(t)]}(Object.keys(S).reduce((t,e)=>(0,n.A)((0,n.A)({},t),{},{[e]:""}),{})),{errors:l,validateForm:d}=function(t,e){const[s,n]=(0,r.useState)({}),i=(0,r.useCallback)(s=>{const{rules:r=[]}=t[s]||{};for(const t of r){var n;const r="string"===typeof t?b[t]:"function"===typeof t?t:null;if(!r)continue;const i=r(null!==(n=e[s])&&void 0!==n?n:"");if(i)return i}return null},[t,e]),o=(0,r.useCallback)(()=>{const e={};return Object.keys(t).forEach(t=>{const s=i(t);s&&(e[t]=s)}),n(e),0===Object.keys(e).length},[t,i]);return{errors:s,validateField:i,validateForm:o}}(S,e),[h,p]=r.useState(!1),[m,f]=r.useState(""),[W,v]=r.useState(!1),R=(0,o.n)({mutationFn:a.KW,onSuccess:()=>{t.invalidateQueries({queryKey:u.e.WORDS_FULL}),p(!0),c(),v(!1)},onError:()=>f("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0432\u043e")});return(0,_.jsxs)("form",{onSubmit:t=>{t.preventDefault(),p(!1),f("");if(!d())return v(!0),void f("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f");R.mutate(e)},className:g.form,noValidate:!0,children:[Object.entries(S).map(t=>{let[r,{label:n,rules:i}]=t;const o=i.includes("required"),a=W&&l[r];return(0,_.jsxs)("label",{className:g.field,children:[(0,_.jsxs)("span",{className:g.caption,children:[n,o&&(0,_.jsx)("span",{className:g.asterisk,children:"*"}),":"]}),(0,_.jsx)("input",{name:r,value:e[r],onChange:s,className:"".concat(g.input," ").concat(a?g.errorInput:"")}),a&&(0,_.jsx)("span",{className:g.errorNote,children:l[r]})]},r)}),(0,_.jsx)("button",{type:"submit",disabled:R.isPending,className:"".concat(g.button," ").concat(Object.keys(l).length?g.buttonInactive:""),children:R.isPending?"\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u2026":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),h&&(0,_.jsx)("p",{className:g.success,children:"\u2705 \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e!"}),m&&(0,_.jsxs)("p",{className:g.error,children:["\u274c ",m]})]})}const v={addWordPage:"AddWordPage_addWordPage__WFs9K",title:"AddWordPage_title__JXZ2w",formWrapper:"AddWordPage_formWrapper__S9MIc"};function R(){return(0,_.jsxs)("div",{className:v.addWordPage,children:[(0,_.jsx)("h2",{className:v.title,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e"}),(0,_.jsx)("div",{className:v.formWrapper,children:(0,_.jsx)(W,{})})]})}},2836:(t,e,s)=>{s.d(e,{n:()=>p});var r=s(2555),n=s(5043),i=s(8664),o=s(116),a=s(9939),u=s(2078);class c extends u.Q{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=this.client.defaultMutationOptions(t),(0,i.f8)(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(e=this.currentMutation)||e.setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(null==(t=this.currentMutation)||t.removeObserver(this))}onMutationUpdate(t){this.updateResult();const e={listeners:!0};"success"===t.type?e.onSuccess=!0:"error"===t.type&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,(0,r.A)((0,r.A)({},this.options),{},{variables:"undefined"!==typeof t?t:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:(0,o.$)(),e="loading"===t.status,s=(0,r.A)((0,r.A)({},t),{},{isLoading:e,isPending:e,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset});this.currentResult=s}notify(t){a.j.batch(()=>{var e,s,r,n;if(this.mutateOptions&&this.hasListeners())if(t.onSuccess)null==(e=(s=this.mutateOptions).onSuccess)||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(r=(n=this.mutateOptions).onSettled)||r.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(t.onError){var i,o,a,u;null==(i=(o=this.mutateOptions).onError)||i.call(o,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(a=(u=this.mutateOptions).onSettled)||a.call(u,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}t.listeners&&this.listeners.forEach(t=>{let{listener:e}=t;e(this.currentResult)})})}}var l=s(8873),d=s(9781),h=s(4084);function p(t,e,s){const o=(0,i.GR)(t,e,s),u=(0,d.jE)({context:o.context}),[p]=n.useState(()=>new c(u,o));n.useEffect(()=>{p.setOptions(o)},[p,o]);const f=(0,l.r)(n.useCallback(t=>p.subscribe(a.j.batchCalls(t)),[p]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),b=n.useCallback((t,e)=>{p.mutate(t,e).catch(m)},[p]);if(f.error&&(0,h.G)(p.options.useErrorBoundary,[f.error]))throw f.error;return(0,r.A)((0,r.A)({},f),{},{mutate:b,mutateAsync:f.mutate})}function m(){}},4834:(t,e,s)=>{s.d(e,{e:()=>r});const r={WORDS:["words"],WORDS_FULL:["wordsFull"],TRAIN_WORDS:["trainWords"],VOCAB_WORDS:["vocabWords"]}},5207:(t,e,s)=>{s.d(e,{Kk:()=>c,KW:()=>l,I0:()=>h,qi:()=>p,ob:()=>d});var r=s(2555),n=s(9722);function i(t){try{return JSON.parse(localStorage.getItem(t))||[]}catch(e){return[]}}function o(t,e){localStorage.setItem(t,JSON.stringify(e))}const a="https://flashcards-api-snowy-mountain-4760.fly.dev",u="addedWords",c="deletedWords";async function l(t){const e=await function(t){return n.A.post("".concat(a,"/words"),t).then(t=>t.data)}(t),s="number"===typeof e.id?e.id:"local-".concat(Date.now()),c=(0,r.A)({id:s},t),l=i(u);return o(u,[...l,c]),c}async function d(t){const e=await function(t){return n.A.put("".concat(a,"/words/").concat(t.id),t).then(t=>t.data)}(t),s="number"===typeof e.id?e.id:t.id,c=(0,r.A)({id:s},t),l=i(u).filter(t=>String(t.id)!==String(s));return o(u,[...l,c]),c}async function h(t){String(t).startsWith("local-")||await function(t){return n.A.delete("".concat(a,"/words/").concat(t))}(t);const e=i(u).filter(e=>String(e.id)!==String(t));o(u,e);const s=i(c);return s.includes(String(t))||o(c,[...s,String(t)]),t}async function p(){const t=await n.A.get("".concat(a,"/words")).then(t=>t.data),e=i(c),s=i(u),r=t.filter(t=>!e.includes(String(t.id)));return[...r.map(t=>s.find(e=>String(e.id)===String(t.id))||t),...s.filter(t=>!r.find(e=>String(e.id)===String(t.id)))]}}}]);
//# sourceMappingURL=774.499b7ea4.chunk.js.map