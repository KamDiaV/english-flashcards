"use strict";(self.webpackChunkenglish_flashcards=self.webpackChunkenglish_flashcards||[]).push([[23],{23:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var r=n(5043),a=n(5604),s=n(1283),i=n(5207),o=n(3546),l=n(5487),c=n(9781),d=n(6273),u=n(4834);const _={cardWrapper:"WordCard_cardWrapper__jHn87",flipIcon:"WordCard_flipIcon__dKwrp",card:"WordCard_card__jVwgg",isFlipped:"WordCard_isFlipped__ACnbb",cardFront:"WordCard_cardFront__tkZO+",cardBack:"WordCard_cardBack__iZQ0q",english:"WordCard_english__5kBOo",transcription:"WordCard_transcription__YMEiV",translation:"WordCard_translation__xCCyt"};var p=n(579);function g(e){let{english:t,transcription:n,russian:a}=e;const[s,i]=(0,r.useState)(!1),o=(0,r.useRef)(null);(0,r.useEffect)(()=>{!s&&o.current&&o.current.focus()},[t,n,s]);const l=e=>{e.stopPropagation(),i(e=>!e)};return(0,p.jsx)("div",{className:_.cardWrapper,onClick:()=>i(e=>!e),children:(0,p.jsxs)("div",{className:"".concat(_.card," ").concat(s?_.isFlipped:""),children:[(0,p.jsxs)("div",{className:_.cardFront,children:[(0,p.jsx)("p",{className:_.english,children:t}),(0,p.jsx)("p",{className:_.transcription,children:n}),(0,p.jsx)("span",{ref:o,className:_.flipIcon,onClick:l,role:"button",tabIndex:0,"aria-label":"Flip card",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),l(e))},children:"\ud83d\udd04"})]}),(0,p.jsxs)("div",{className:_.cardBack,children:[(0,p.jsx)("p",{className:_.translation,children:a}),(0,p.jsx)("span",{className:_.flipIcon,onClick:l,role:"button",tabIndex:0,"aria-label":"Flip card back",children:"\ud83d\udd04"})]})]})})}const h={container:"FlipCardGame_container__9peXM",cardWrapper:"FlipCardGame_cardWrapper__e66if",cardMotion:"FlipCardGame_cardMotion__ovtHr",learnedCounter:"FlipCardGame_learnedCounter__QZj3u",checkButton:"FlipCardGame_checkButton__427CO",controls:"FlipCardGame_controls__-ewaO",status:"FlipCardGame_status__0RBR1"};function m(e){var t;let{words:n}=e;const a=(0,c.jE)(),[s,i]=(0,r.useState)(0),[_,m]=(0,r.useState)(1),[f,x]=(0,r.useState)(!1),[v,S]=(0,r.useState)(0),C=Array.isArray(n)&&n.length?Math.min(s,n.length-1):0,j=Array.isArray(n)&&n.length?n[C]:{id:null,english:"",transcription:"",russian:""},[k,y]=(0,d.p)(null!==(t=j.id)&&void 0!==t?t:""),w=(0,r.useCallback)(()=>{null!==n&&void 0!==n&&n.length&&0!==C&&(m(-1),i(e=>e-1))},[C,n]),N=(0,r.useCallback)(()=>{null!==n&&void 0!==n&&n.length&&C!==n.length-1&&(m(1),i(e=>e+1))},[C,n]);(0,r.useEffect)(()=>{function e(e){"ArrowLeft"===e.key?(e.preventDefault(),w()):"ArrowRight"===e.key&&(e.preventDefault(),N())}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[w,N]);return(0,p.jsx)("div",{className:h.container,children:null!==n&&void 0!==n&&n.length?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:h.learnedCounter,children:["\u0412\u044b\u0443\u0447\u0435\u043d\u043e \u0441\u043b\u043e\u0432 \u0437\u0430 \u044d\u0442\u0443 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0443: ",(0,p.jsx)("strong",{children:v})]}),(0,p.jsx)("div",{className:h.cardWrapper,children:(0,p.jsx)(o.N,{initial:!1,custom:_,children:(0,p.jsx)(l.P.div,{custom:_,variants:{enter:e=>({rotateY:e>0?90:-90,opacity:0,transformOrigin:e>0?"left center":"right center"}),center:{rotateY:0,opacity:1,transformOrigin:"center center",transition:{duration:.5}},exit:e=>({rotateY:e>0?-90:90,opacity:0,transformOrigin:e>0?"right center":"left center",transition:{duration:.4}})},initial:"enter",animate:f?"exit":"center",exit:"exit",transition:{duration:.5},className:h.cardMotion,children:(0,p.jsx)(g,{english:j.english,transcription:j.transcription,russian:j.russian})},j.id)})}),(0,p.jsx)("button",{className:h.checkButton,onClick:function(){y({knownByUser:!0}),a.invalidateQueries({queryKey:u.e.TRAIN_WORDS}),a.invalidateQueries({queryKey:u.e.VOCAB_WORDS}),x(!0),S(e=>e+1),setTimeout(()=>{x(!1),N()},500)},disabled:f,children:"\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u043a\u0430\u043a \u0437\u043d\u0430\u044e"}),(0,p.jsxs)("div",{className:h.controls,children:[(0,p.jsx)("button",{onClick:w,disabled:0===C,children:"\u2190"}),(0,p.jsx)("button",{onClick:N,disabled:C===n.length-1,children:"\u2192"})]})]}):(0,p.jsx)("p",{className:h.status,children:"\u041d\u0435\u0442 \u0441\u043b\u043e\u0432 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438."})})}var f=n(2555);function x(e){return e.map(e=>({sort:Math.random(),value:e})).sort((e,t)=>e.sort-t.sort).map(e=>e.value)}function v(e){const t=(0,c.jE)(),[n,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(null),[_,p]=(0,r.useState)(null),[g,h]=(0,r.useState)(null),[m,f]=(0,r.useState)("en-ru"),{data:v=[],isLoading:S,isError:C}=(0,a.I)({queryKey:u.e.WORDS_FULL,queryFn:i.qi,refetchOnWindowFocus:!1,staleTime:3e5}),{empty:j,safeIndex:k,word:y,currentId:w,next:N,reset:b}=function(e){var t;const[n,a]=(0,r.useState)(0),s=!Array.isArray(e)||0===e.length,i=s?0:Math.min(n,e.length-1),o=s?null:e[i],l=null!==(t=null===o||void 0===o?void 0:o.id)&&void 0!==t?t:null;return(0,r.useEffect)(()=>{a(0)},[e]),{safeIndex:i,word:o,currentId:l,next:()=>{s||a(t=>t<e.length-1?t+1:t)},reset:()=>{a(0)},empty:s}}(e);(0,r.useEffect)(()=>{s(!1),l(null),p(null),h(null)},[w]);const[A,T]=(0,d.p)(w),{correctStreak:W=0}=A,{options:O,correctAnswer:B}=function(e,t,n,a){return(0,r.useMemo)(()=>{var r,s;if(!Array.isArray(t)||!t.length||n<0||n>=t.length)return{options:[],correctAnswer:null};const i=t[n];if(!i)return{options:[],correctAnswer:null};const o="en-ru"===a?i.russian:i.english,l=null!==(r=null===(s=o.toLowerCase)||void 0===s?void 0:s.call(o))&&void 0!==r?r:"",c=(Array.isArray(e)?e:[]).filter(e=>e.id!==i.id).map(e=>"en-ru"===a?e.russian:e.english).filter(e=>!!e&&e.toLowerCase()!==l);let d=[o,...x([...new Set(c)]).slice(0,3)];for(;d.length<4;){const e=d[Math.floor(Math.random()*d.length)];d.push(e)}return d=d.length>4?x(d).slice(0,4):x(d),{options:d,correctAnswer:l}},[e,t,n,a])}(v,e,k,m),I=(0,r.useCallback)(()=>{t.invalidateQueries({queryKey:u.e.TRAIN_WORDS}),t.invalidateQueries({queryKey:u.e.VOCAB_WORDS})},[t]),F=(0,r.useCallback)(()=>{p(null),h(null),s(!1),l(null)},[]),G=(0,r.useCallback)(e=>{if(null!==_)return;p(e);const t=e.toLowerCase()===B;h(t);const n=t?W+1:0,r={correctStreak:n};if(n>=5&&(r.knownByUser=!0),T(r),t&&n>=5)return s(!0),void l(n);I()},[_,B,W,T,I]),D=(0,r.useCallback)(e=>{null===e||void 0===e||e.stopPropagation(),n&&(s(!1),l(null),p(null),h(null),I())},[n,I]),L=null!==o&&void 0!==o?o:W,E=Math.min(L,5);return{isLoading:S,isError:C,empty:j,word:y,safeIndex:k,next:N,reset:b,direction:m,setDirection:f,options:O,correctAnswer:B,selected:_,isCorrect:g,rawCount:L,displayCount:E,celebrating:n,handleSelect:G,handleScreenClick:D,handleClearSelection:F}}var S=n(6232);const C={container:"TestGame_container__W4QCg",toggle:"TestGame_toggle__d5eTu",active:"TestGame_active__5REuC",prompt:"TestGame_prompt__D27ei",status:"TestGame_status__yVXDb",progress:"TestGame_progress__vcjdz",options:"TestGame_options__NDWIb",correct:"TestGame_correct__afOdp",wrong:"TestGame_wrong__N3fIA",footer:"TestGame_footer__jXnw9",ok:"TestGame_ok__hxm7a",err:"TestGame_err__fUU1S",nextButton:"TestGame_nextButton__BTOoP",resetButton:"TestGame_resetButton__dw-D+",celebration:"TestGame_celebration__YTn-x",pop:"TestGame_pop__X1akE"};function j(e){const{isLoading:t,isError:n,empty:r,word:a,direction:s,setDirection:i,options:o,correctAnswer:l,selected:c,isCorrect:d,rawCount:u,displayCount:_,celebrating:g,handleSelect:h,handleScreenClick:m,next:f,reset:x,safeIndex:v,wordsLength:j,handleClearSelection:k}=e;return t?(0,p.jsx)(S.A,{}):n?(0,p.jsx)("p",{className:C.status,children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"}):r||e.knownByUser&&!g?(0,p.jsx)(S.A,{}):(0,p.jsxs)("div",{className:C.container,onClick:e=>m(e),children:[(0,p.jsxs)("div",{className:C.toggle,children:[(0,p.jsx)("button",{className:"en-ru"===s?C.active:"",onClick:()=>i("en-ru"),children:"\u0410\u043d\u0433\u043b \u2192 \u0420\u0443\u0441"}),(0,p.jsx)("button",{className:"ru-en"===s?C.active:"",onClick:()=>i("ru-en"),children:"\u0420\u0443\u0441 \u2192 \u0410\u043d\u0433\u043b"})]}),(0,p.jsx)("p",{className:C.prompt,children:"en-ru"===s?a.english:a.russian}),(0,p.jsxs)("div",{className:C.progress,children:[(0,p.jsx)("progress",{value:_,max:5}),(0,p.jsxs)("span",{children:[_,"/5"]})]}),(0,p.jsx)("div",{className:C.options,children:o.map((e,t)=>(0,p.jsx)("button",{disabled:null!==c||g,onClick:t=>{t.stopPropagation(),h(e)},className:null===c?"":e.toLowerCase()===l?C.correct:e===c?C.wrong:"",children:e},"".concat(e,"-").concat(t)))}),g&&(0,p.jsx)("div",{className:C.celebration,children:"\ud83c\udf89\ud83c\udf86 \u041e\u0442\u043b\u0438\u0447\u043d\u043e! \u0421\u043b\u043e\u0432\u043e \u0432\u044b\u0443\u0447\u0435\u043d\u043e! \ud83c\udf86\ud83c\udf89"}),!g&&null!==c&&(0,p.jsxs)("div",{className:C.footer,children:[(0,p.jsx)("p",{className:d?C.ok:C.err,children:d?"\u2705 \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e!":"\u274c \u041d\u0435\u0432\u0435\u0440\u043d\u043e, \u043e\u0442\u0432\u0435\u0442: ".concat("en-ru"===s?a.russian:a.english)}),(0,p.jsx)("button",{onClick:()=>{k(),f()},disabled:v===j-1,className:C.nextButton,children:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435 \u2192"}),v===j-1&&(0,p.jsx)("button",{onClick:()=>{k(),x()},className:C.resetButton,children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u043d\u0430\u0447\u0430\u043b\u0430"})]})]})}function k(e){let{words:t}=e;const n=v(t);return(0,p.jsx)(j,(0,f.A)((0,f.A)({},n),{},{wordsLength:t.length}))}const y={page:"TrainPage_page__AVj1k",backToMenu:"TrainPage_backToMenu__-9L1e",title:"TrainPage_title__L3Yo3",selection:"TrainPage_selection__pdbK7",largeButton:"TrainPage_largeButton__Xu2N9",status:"TrainPage_status__84YyE",emptyActions:"TrainPage_emptyActions__otEk2",linkButton:"TrainPage_linkButton__dh8CD"};async function w(){const e=await(0,i.qi)(),t=JSON.parse(localStorage.getItem("vocabProgress")||"{}"),n=JSON.parse(localStorage.getItem(i.Kk)||"[]");return e.filter(e=>{var r;return!(null!==(r=t[e.id])&&void 0!==r&&r.knownByUser)&&!n.includes(String(e.id))})}function N(){const[e,t]=(0,r.useState)(null),{data:n=[],isLoading:i,isError:o}=(0,a.I)({queryKey:["trainWords",e],queryFn:w,enabled:Boolean(e),refetchOnWindowFocus:!1,staleTime:3e5});return null===e?(0,p.jsxs)("div",{className:y.page,children:[(0,p.jsx)("h2",{className:y.title,children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0436\u0438\u043c"}),(0,p.jsxs)("div",{className:y.selection,children:[(0,p.jsx)("button",{className:y.largeButton,onClick:()=>t("flip"),children:"\u041f\u0435\u0440\u0435\u0432\u0435\u0440\u043d\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443"}),(0,p.jsx)("button",{className:y.largeButton,onClick:()=>t("test"),children:"\u0422\u0435\u0441\u0442"})]})]}):i?(0,p.jsx)("p",{className:y.status,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043b\u043e\u0432\u2026"}):o?(0,p.jsx)("p",{className:y.status,children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435"}):0===n.length?(0,p.jsxs)("div",{className:y.page,children:[(0,p.jsx)("h2",{className:y.status,children:"\u041f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u044f\u0435\u043c, \u0432\u0441\u0435 \u0441\u043b\u043e\u0432\u0430 \u0432\u044b\u0443\u0447\u0435\u043d\u044b! \ud83c\udf89"}),(0,p.jsxs)("div",{className:y.emptyActions,children:[(0,p.jsx)(s.N_,{to:"/vocab",className:y.linkButton,children:"\u041c\u043e\u0439 \u0441\u043b\u043e\u0432\u0430\u0440\u043d\u044b\u0439 \u0437\u0430\u043f\u0430\u0441"}),(0,p.jsx)(s.N_,{to:"/add",className:y.linkButton,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0441\u043b\u043e\u0432\u0430"})]})]}):(0,p.jsxs)("div",{className:y.page,children:[(0,p.jsx)("button",{className:y.backToMenu,onClick:()=>t(null),children:"\u2190 \u041d\u0430\u0437\u0430\u0434 \u043a \u0432\u044b\u0431\u043e\u0440\u0443 \u0440\u0435\u0436\u0438\u043c\u0430"}),"flip"===e?(0,p.jsx)(m,{words:n}):(0,p.jsx)(k,{words:n})]})}},4834:(e,t,n)=>{n.d(t,{e:()=>r});const r={WORDS:["words"],WORDS_FULL:["wordsFull"],TRAIN_WORDS:["trainWords"],VOCAB_WORDS:["vocabWords"]}},5207:(e,t,n)=>{n.d(t,{Kk:()=>c,KW:()=>g,I0:()=>m,qi:()=>f,ob:()=>h});var r=n(2555),a=n(9722);function s(e){try{return JSON.parse(localStorage.getItem(e))||[]}catch(t){return[]}}function i(e,t){localStorage.setItem(e,JSON.stringify(t))}const o="https://flashcards-api-snowy-mountain-4760.fly.dev",l="addedWords",c="deletedWords",d=()=>a.A.get("".concat(o,"/words")).then(e=>e.data),u=e=>a.A.post("".concat(o,"/words"),e).then(e=>e.data),_=e=>a.A.put("".concat(o,"/words/").concat(e.id),e).then(e=>e.data),p=e=>a.A.delete("".concat(o,"/words/").concat(e));async function g(e){try{const t=await u(e);if(null!=(null===t||void 0===t?void 0:t.id)){const n=s(l).filter(t=>String(t.english).toLowerCase()!==e.english.toLowerCase());return i(l,n),t}}catch(a){}const t=(0,r.A)({id:"local-".concat(Date.now())},e),n=s(l);return i(l,[...n,t]),t}async function h(e){const t=await _(e),n="number"===typeof t.id?t.id:e.id,a=(0,r.A)({id:n},e),o=s(l).filter(e=>String(e.id)!==String(n));return i(l,[...o,a]),a}async function m(e){String(e).startsWith("local-")||await p(e);const t=s(l).filter(t=>String(t.id)!==String(e));i(l,t);const n=s(c);return n.includes(String(e))||i(c,[...n,String(e)]),e}async function f(){const e=await d(),t=s(c),n=s(l),r=e.filter(e=>!t.includes(String(e.id)));return[...r.map(e=>n.find(t=>String(t.id)===String(e.id))||e),...n.filter(e=>!r.find(t=>String(t.id)===String(e.id)))]}},6273:(e,t,n)=>{n.d(t,{R:()=>l,p:()=>o});var r=n(2555),a=n(5043);const s="vocabProgress",i={correctStreak:0,knownByUser:!1};function o(e){const[t,n]=(0,a.useState)(i);(0,a.useEffect)(()=>{const t=JSON.parse(localStorage.getItem(s)||"{}");n(t[e]||i)},[e]);return[t,t=>{n(n=>{const a=(0,r.A)((0,r.A)({},n),t),i=JSON.parse(localStorage.getItem(s)||"{}");return i[e]=a,localStorage.setItem(s,JSON.stringify(i)),a})},()=>{n(i);const t=JSON.parse(localStorage.getItem(s)||"{}");delete t[e],localStorage.setItem(s,JSON.stringify(t))}]}function l(e){const t=JSON.parse(localStorage.getItem(s)||"{}");delete t[e],localStorage.setItem(s,JSON.stringify(t))}}}]);
//# sourceMappingURL=23.5e656043.chunk.js.map