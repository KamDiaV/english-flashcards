"use strict";(self.webpackChunkenglish_flashcards=self.webpackChunkenglish_flashcards||[]).push([[347],{8347:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});var n=r(5043),s=r(5604),a=r(5180),i=r(9766),o=r(3546),l=r(5487),c=r(9781),d=r(8659);const u={cardWrapper:"WordCard_cardWrapper__jHn87",card:"WordCard_card__jVwgg",isFlipped:"WordCard_isFlipped__ACnbb",cardFront:"WordCard_cardFront__tkZO+",cardBack:"WordCard_cardBack__iZQ0q",english:"WordCard_english__5kBOo",transcription:"WordCard_transcription__YMEiV",translation:"WordCard_translation__xCCyt"};var g=r(579);function p(e){let{english:t,transcription:r,russian:s}=e;const[a,i]=(0,n.useState)(!1);return(0,g.jsx)("div",{className:u.cardWrapper,onClick:()=>i((e=>!e)),children:(0,g.jsxs)("div",{className:`${u.card} ${a?u.isFlipped:""}`,children:[(0,g.jsxs)("div",{className:u.cardFront,children:[(0,g.jsx)("p",{className:u.english,children:t}),(0,g.jsx)("p",{className:u.transcription,children:r})]}),(0,g.jsx)("div",{className:u.cardBack,children:(0,g.jsx)("p",{className:u.translation,children:s})})]})})}const m={container:"FlipCardGame_container__9peXM",cardWrapper:"FlipCardGame_cardWrapper__e66if",cardMotion:"FlipCardGame_cardMotion__ovtHr",checkButton:"FlipCardGame_checkButton__427CO",controls:"FlipCardGame_controls__-ewaO",status:"FlipCardGame_status__0RBR1"};function _(e){var t;let{words:r}=e;const[s,a]=(0,n.useState)(0),[i,u]=(0,n.useState)(1),[_,h]=(0,n.useState)(!1),f=(0,c.jE)(),x=Array.isArray(r)&&r.length>0?Math.min(s,r.length-1):0,S=Array.isArray(r)&&r.length>0?r[x]:{id:null,english:"",transcription:"",russian:""},[N,k]=(0,d.p)(null!==(t=S.id)&&void 0!==t?t:""),j=(0,n.useCallback)((()=>{Array.isArray(r)&&0!==r.length&&0!==x&&(u(-1),a((e=>e-1)))}),[x,r]),w=(0,n.useCallback)((()=>{Array.isArray(r)&&0!==r.length&&x!==r.length-1&&(u(1),a((e=>e+1)))}),[x,r]);(0,n.useEffect)((()=>{function e(e){"ArrowLeft"===e.key?(e.preventDefault(),j()):"ArrowRight"===e.key&&(e.preventDefault(),w())}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[j,w]);return(0,g.jsx)("div",{className:m.container,children:Array.isArray(r)&&0!==r.length?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:m.cardWrapper,children:(0,g.jsx)(o.N,{initial:!1,custom:i,children:(0,g.jsx)(l.P.div,{custom:i,variants:{enter:e=>({rotateY:e>0?90:-90,opacity:0,transformOrigin:e>0?"left center":"right center"}),center:{rotateY:0,opacity:1,transformOrigin:"center center",transition:{duration:.5}},exit:e=>({rotateY:e>0?-90:90,opacity:0,transformOrigin:e>0?"right center":"left center",transition:{duration:.4}})},initial:"enter",animate:_?"exit":"center",exit:"exit",transition:{duration:.5},className:m.cardMotion,onAnimationComplete:function(e){_&&"exit"===e&&(h(!1),w())},children:(0,g.jsx)(p,{english:S.english,transcription:S.transcription,russian:S.russian})},S.id)})}),(0,g.jsx)("button",{className:m.checkButton,onClick:function(){k({knownByUser:!0}),f.invalidateQueries(["trainWords"]),f.invalidateQueries(["vocabWords"]),h(!0)},disabled:_,children:"\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u043a\u0430\u043a \u0437\u043d\u0430\u044e"}),(0,g.jsxs)("div",{className:m.controls,children:[(0,g.jsx)("button",{onClick:j,disabled:0===x,children:"\u2190"}),(0,g.jsx)("button",{onClick:w,disabled:x===r.length-1,children:"\u2192"})]})]}):(0,g.jsx)("p",{className:m.status,children:"\u041d\u0435\u0442 \u0441\u043b\u043e\u0432 \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0438."})})}function h(e){return e.map((e=>({sort:Math.random(),value:e}))).sort(((e,t)=>e.sort-t.sort)).map((e=>e.value))}function f(e){const t=(0,c.jE)(),[r,a]=(0,n.useState)(!1),[o,l]=(0,n.useState)(null),[u,g]=(0,n.useState)(null),[p,m]=(0,n.useState)(null),[_,f]=(0,n.useState)("en-ru"),{data:x=[],isLoading:S,isError:N}=(0,s.I)(["wordsFull"],i.qi,{refetchOnWindowFocus:!1,staleTime:3e5}),{empty:k,safeIndex:j,word:w,currentId:y,next:v,reset:C}=function(e){var t;const[r,s]=(0,n.useState)(0),a=!Array.isArray(e)||0===e.length,i=a?0:Math.min(r,e.length-1),o=a?null:e[i],l=null!==(t=null===o||void 0===o?void 0:o.id)&&void 0!==t?t:null;return(0,n.useEffect)((()=>{s(0)}),[e]),{safeIndex:i,word:o,currentId:l,next:()=>{a||s((t=>t<e.length-1?t+1:t))},reset:()=>{s(0)},empty:a}}(e);(0,n.useEffect)((()=>{a(!1),l(null),g(null),m(null)}),[y]);const[b,A]=(0,d.p)(y),{correctStreak:T=0,knownByUser:B=!1}=b,{options:I,correctAnswer:O}=function(e,t,r,s){return(0,n.useMemo)((()=>{if(!Array.isArray(t)||0===t.length||r<0||r>=t.length)return{options:[],correctAnswer:null};const n=t[r];if(!n||!Array.isArray(e)||0===e.length)return{options:[],correctAnswer:null};const a=h(e.filter((e=>e.id!==n.id)).map((e=>"en-ru"===s?e.russian:e.english))).slice(0,3),i="en-ru"===s?n.russian:n.english;return{options:h([i,...a]),correctAnswer:i.toLowerCase()}}),[e,t,r,s])}(x,e,j,_),W=(0,n.useCallback)((()=>{g(null),m(null),a(!1),l(null)}),[]),G=(0,n.useCallback)((()=>{t.invalidateQueries({predicate:e=>["trainWords","vocabWords"].includes(e.queryKey[0])})}),[t]),J=(0,n.useCallback)((e=>{if(null!==u)return;g(e);const t=e.toLowerCase()===O;m(t);const r=t?T+1:0,n={correctStreak:r};r>=5&&(n.knownByUser=!0),A(n),t&&r>=5?(a(!0),l(r)):G()}),[u,O,T,A,G]),E=(0,n.useCallback)((()=>{r&&(a(!1),l(null),g(null),m(null),G())}),[r,G]),F=null!==o&&void 0!==o?o:T,L=Math.min(F,5);return{isLoading:S,isError:N,empty:k,word:w,safeIndex:j,direction:_,setDirection:f,options:I,correctAnswer:O,selected:u,isCorrect:p,rawCount:F,displayCount:L,celebrating:r,handleSelect:J,handleScreenClick:E,handleClearSelection:W,next:v,reset:C}}var x=r(6232);const S={container:"TestGame_container__W4QCg",toggle:"TestGame_toggle__d5eTu",active:"TestGame_active__5REuC",prompt:"TestGame_prompt__D27ei",status:"TestGame_status__yVXDb",progress:"TestGame_progress__vcjdz",options:"TestGame_options__NDWIb",correct:"TestGame_correct__afOdp",wrong:"TestGame_wrong__N3fIA",footer:"TestGame_footer__jXnw9",ok:"TestGame_ok__hxm7a",err:"TestGame_err__fUU1S",nextButton:"TestGame_nextButton__BTOoP",resetButton:"TestGame_resetButton__dw-D+",celebration:"TestGame_celebration__YTn-x",pop:"TestGame_pop__X1akE"};function N(e){const{isLoading:t,isError:r,empty:n,word:s,direction:a,setDirection:i,options:o,correctAnswer:l,selected:c,isCorrect:d,rawCount:u,displayCount:p,celebrating:m,handleSelect:_,handleScreenClick:h,next:f,reset:N,safeIndex:k,wordsLength:j,handleClearSelection:w}=e;return t?(0,g.jsx)(x.A,{}):r?(0,g.jsx)("p",{className:S.status,children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"}):n||e.knownByUser&&!m?(0,g.jsx)(x.A,{}):(0,g.jsxs)("div",{className:S.container,onClick:h,children:[(0,g.jsxs)("div",{className:S.toggle,children:[(0,g.jsx)("button",{className:"en-ru"===a?S.active:"",onClick:()=>i("en-ru"),children:"\u0410\u043d\u0433\u043b \u2192 \u0420\u0443\u0441"}),(0,g.jsx)("button",{className:"ru-en"===a?S.active:"",onClick:()=>i("ru-en"),children:"\u0420\u0443\u0441 \u2192 \u0410\u043d\u0433\u043b"})]}),(0,g.jsx)("p",{className:S.prompt,children:"en-ru"===a?s.english:s.russian}),(0,g.jsxs)("div",{className:S.progress,children:[(0,g.jsx)("progress",{value:p,max:5}),(0,g.jsxs)("span",{children:[p,"/5"]})]}),(0,g.jsx)("div",{className:S.options,children:o.map((e=>(0,g.jsx)("button",{disabled:null!==c||m,onClick:t=>{t.stopPropagation(),_(e)},className:null===c?"":e.toLowerCase()===l?S.correct:e===c?S.wrong:"",children:e},e)))}),m&&(0,g.jsx)("div",{className:S.celebration,children:"\ud83c\udf89\ud83c\udf86 \u041e\u0442\u043b\u0438\u0447\u043d\u043e! \u0421\u043b\u043e\u0432\u043e \u0432\u044b\u0443\u0447\u0435\u043d\u043e! \ud83c\udf86\ud83c\udf89"}),!m&&null!==c&&(0,g.jsxs)("div",{className:S.footer,children:[(0,g.jsx)("p",{className:d?S.ok:S.err,children:d?"\u2705 \u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e!":`\u274c \u041d\u0435\u0432\u0435\u0440\u043d\u043e, \u043e\u0442\u0432\u0435\u0442: ${"en-ru"===a?s.russian:s.english}`}),(0,g.jsx)("button",{onClick:()=>{w(),f()},disabled:k===j-1,className:S.nextButton,children:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0435 \u2192"}),k===j-1&&(0,g.jsx)("button",{onClick:()=>{w(),N()},className:S.resetButton,children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0441\u043d\u0430\u0447\u0430\u043b\u0430"})]})]})}function k(e){let{words:t}=e;const r=f(t);return(0,g.jsx)(N,{...r,wordsLength:t.length})}const j={page:"TrainPage_page__AVj1k",backToMenu:"TrainPage_backToMenu__-9L1e",title:"TrainPage_title__L3Yo3",selection:"TrainPage_selection__pdbK7",largeButton:"TrainPage_largeButton__Xu2N9",status:"TrainPage_status__84YyE",emptyActions:"TrainPage_emptyActions__otEk2",linkButton:"TrainPage_linkButton__dh8CD"};async function w(){const e=await(0,i.qi)(),t=JSON.parse(localStorage.getItem("vocabProgress")||"{}"),r=JSON.parse(localStorage.getItem(i.Kk)||"[]");return e.filter((e=>{var n;return!(null!==(n=t[e.id])&&void 0!==n&&n.knownByUser)&&!r.includes(String(e.id))}))}function y(){const[e,t]=(0,n.useState)(null),{data:r=[],isLoading:i,isError:o}=(0,s.I)(["trainWords",e],w,{enabled:Boolean(e),refetchOnWindowFocus:!1,staleTime:3e5});return null===e?(0,g.jsxs)("div",{className:j.page,children:[(0,g.jsx)("h2",{className:j.title,children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0436\u0438\u043c"}),(0,g.jsxs)("div",{className:j.selection,children:[(0,g.jsx)("button",{className:j.largeButton,onClick:()=>t("flip"),children:"\u041f\u0435\u0440\u0435\u0432\u0435\u0440\u043d\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443"}),(0,g.jsx)("button",{className:j.largeButton,onClick:()=>t("test"),children:"\u0422\u0435\u0441\u0442"})]})]}):i?(0,g.jsx)("p",{className:j.status,children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043b\u043e\u0432\u2026"}):o?(0,g.jsx)("p",{className:j.status,children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435"}):0===r.length?(0,g.jsxs)("div",{className:j.page,children:[(0,g.jsx)("h2",{className:j.status,children:"\u041f\u043e\u0437\u0434\u0440\u0430\u0432\u043b\u044f\u0435\u043c, \u0432\u0441\u0435 \u0441\u043b\u043e\u0432\u0430 \u0432\u044b\u0443\u0447\u0435\u043d\u044b! \ud83c\udf89"}),(0,g.jsxs)("div",{className:j.emptyActions,children:[(0,g.jsx)(a.N_,{to:"/vocab",className:j.linkButton,children:"\u041c\u043e\u0439 \u0441\u043b\u043e\u0432\u0430\u0440\u043d\u044b\u0439 \u0437\u0430\u043f\u0430\u0441"}),(0,g.jsx)(a.N_,{to:"/add",className:j.linkButton,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u0441\u043b\u043e\u0432\u0430"})]})]}):(0,g.jsxs)("div",{className:j.page,children:[(0,g.jsx)("button",{className:j.backToMenu,onClick:()=>t(null),children:"\u2190 \u041d\u0430\u0437\u0430\u0434 \u043a \u0432\u044b\u0431\u043e\u0440\u0443 \u0440\u0435\u0436\u0438\u043c\u0430"}),"flip"===e?(0,g.jsx)(_,{words:r}):(0,g.jsx)(k,{words:r})]})}},8659:(e,t,r)=>{r.d(t,{R:()=>o,p:()=>i});var n=r(5043);const s="vocabProgress",a={correctStreak:0,knownByUser:!1};function i(e){const[t,r]=(0,n.useState)(a);(0,n.useEffect)((()=>{const t=JSON.parse(localStorage.getItem(s)||"{}");r(t[e]||a)}),[e]);return[t,t=>{r((r=>{const n={...r,...t},a=JSON.parse(localStorage.getItem(s)||"{}");return a[e]=n,localStorage.setItem(s,JSON.stringify(a)),n}))},()=>{r(a);const t=JSON.parse(localStorage.getItem(s)||"{}");delete t[e],localStorage.setItem(s,JSON.stringify(t))}]}function o(e){const t=JSON.parse(localStorage.getItem(s)||"{}");delete t[e],localStorage.setItem(s,JSON.stringify(t))}},9766:(e,t,r)=>{r.d(t,{I0:()=>c,KW:()=>o,Kk:()=>i,ob:()=>l,qi:()=>d});var n=r(6213);const s="https://itgirlschool.justmakeit.ru/api",a="addedWords",i="deletedWords";async function o(e){const t=await function(e){return n.A.post(`${s}/words`,e).then((e=>e.data))}(e),r={id:"number"===typeof t.id?t.id:`local-${Date.now()}`,english:e.english,transcription:e.transcription,russian:e.russian,tags:e.tags},i=JSON.parse(localStorage.getItem(a)||"[]");return localStorage.setItem(a,JSON.stringify([...i,r])),r}async function l(e){const t=await function(e){return n.A.put(`${s}/words/${e.id}`,e).then((e=>e.data))}(e),r="number"===typeof t.id?t.id:e.id,i={id:r,english:e.english,transcription:e.transcription,russian:e.russian,tags:e.tags},o=JSON.parse(localStorage.getItem(a)||"[]").filter((e=>String(e.id)!==String(r)));return localStorage.setItem(a,JSON.stringify([...o,i])),i}async function c(e){String(e).startsWith("local-")||await function(e){return n.A.delete(`${s}/words/${e}`)}(e);const t=JSON.parse(localStorage.getItem(a)||"[]").filter((t=>String(t.id)!==String(e)));localStorage.setItem(a,JSON.stringify(t));const r=JSON.parse(localStorage.getItem(i)||"[]");return r.includes(String(e))||(r.push(String(e)),localStorage.setItem(i,JSON.stringify(r))),e}async function d(){const e=await n.A.get(`${s}/words`).then((e=>e.data)),t=JSON.parse(localStorage.getItem(i)||"[]"),r=JSON.parse(localStorage.getItem(a)||"[]"),o=e.filter((e=>!t.includes(String(e.id))));return[...o.map((e=>r.find((t=>String(t.id)===String(e.id)))||e)),...r.filter((e=>!o.find((t=>String(t.id)===String(e.id)))))]}}}]);
//# sourceMappingURL=347.add83bd4.chunk.js.map