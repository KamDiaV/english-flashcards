"use strict";(self.webpackChunkenglish_flashcards=self.webpackChunkenglish_flashcards||[]).push([[241],{2836:(t,e,s)=>{s.d(e,{n:()=>h});var r=s(5043),n=s(8664),i=s(116),a=s(9939),o=s(2078);class u extends o.Q{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=this.client.defaultMutationOptions(t),(0,n.f8)(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(e=this.currentMutation)||e.setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(null==(t=this.currentMutation)||t.removeObserver(this))}onMutationUpdate(t){this.updateResult();const e={listeners:!0};"success"===t.type?e.onSuccess=!0:"error"===t.type&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:"undefined"!==typeof t?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:(0,i.$)(),e={...t,isLoading:"loading"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){a.j.batch((()=>{var e,s,r,n;if(this.mutateOptions&&this.hasListeners())if(t.onSuccess)null==(e=(s=this.mutateOptions).onSuccess)||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(r=(n=this.mutateOptions).onSettled)||r.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(t.onError){var i,a,o,u;null==(i=(a=this.mutateOptions).onError)||i.call(a,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(o=(u=this.mutateOptions).onSettled)||o.call(u,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}t.listeners&&this.listeners.forEach((t=>{let{listener:e}=t;e(this.currentResult)}))}))}}var l=s(8873),c=s(9781),d=s(4084);function h(t,e,s){const i=(0,n.GR)(t,e,s),o=(0,c.jE)({context:i.context}),[h]=r.useState((()=>new u(o,i)));r.useEffect((()=>{h.setOptions(i)}),[h,i]);const m=(0,l.r)(r.useCallback((t=>h.subscribe(a.j.batchCalls(t))),[h]),(()=>h.getCurrentResult()),(()=>h.getCurrentResult())),g=r.useCallback(((t,e)=>{h.mutate(t,e).catch(p)}),[h]);if(m.error&&(0,d.G)(h.options.useErrorBoundary,[m.error]))throw m.error;return{...m,mutate:g,mutateAsync:m.mutate}}function p(){}},5241:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var r=s(5043),n=s(9781),i=s(2836),a=s(9766);const o={form:"AddWordForm_form__3YoZc",field:"AddWordForm_field__CR9-8",input:"AddWordForm_input__GQ-nM",errorInput:"AddWordForm_errorInput__4f3O7",button:"AddWordForm_button__eQWs4",buttonInactive:"AddWordForm_buttonInactive__EVScR",success:"AddWordForm_success__oroQ-",error:"AddWordForm_error__5DqMM"};var u=s(579);const l=[{name:"english",label:"\u0421\u043b\u043e\u0432\u043e (\u0430\u043d\u0433\u043b.)",required:!0},{name:"transcription",label:"\u0422\u0440\u0430\u043d\u0441\u043a\u0440\u0438\u043f\u0446\u0438\u044f",required:!0},{name:"russian",label:"\u041f\u0435\u0440\u0435\u0432\u043e\u0434",required:!0},{name:"tags",label:"\u0422\u0435\u043c\u0430",required:!0}];function c(){const t=(0,n.jE)(),[e,s,c]=function(t){const[e,s]=(0,r.useState)(t);return[e,t=>{const{name:e,value:r}=t.target;s((t=>({...t,[e]:r})))},()=>s(t)]}({english:"",transcription:"",russian:"",tags:""}),[d,h]=r.useState(!1),[p,m]=r.useState(""),[g,f]=r.useState(!1),S=r.useMemo((()=>l.reduce(((t,s)=>{let{name:r,required:n}=s;return n&&!e[r].trim()&&(t[r]=!0),t}),{})),[e]),b=0===Object.keys(S).length,_=(0,i.n)(a.KW,{onSuccess:()=>{t.invalidateQueries(["words"]),h(!0),m(""),c(),f(!1)},onError:()=>{m("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0432\u043e"),h(!1)}});return(0,u.jsxs)("form",{onSubmit:t=>{t.preventDefault(),h(!1),m(""),b?_.mutate(e):m("\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f")},className:o.form,noValidate:!0,children:[l.map((t=>{let{name:r,label:n}=t;return(0,u.jsxs)("label",{className:o.field,children:[n,":",(0,u.jsx)("input",{name:r,value:e[r],onChange:s,className:`${o.input} ${g&&S[r]?o.errorInput:""}`})]},r)})),(0,u.jsx)("button",{type:"submit",onClick:()=>{b||f(!0)},className:`${o.button} ${b?"":o.buttonInactive}`,children:_.isLoading?"\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u2026":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),d&&(0,u.jsx)("p",{className:o.success,children:"\u2705 \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e!"}),p&&(0,u.jsxs)("p",{className:o.error,children:["\u274c ",p]})]})}const d={addWordPage:"AddWordPage_addWordPage__WFs9K",title:"AddWordPage_title__JXZ2w",formWrapper:"AddWordPage_formWrapper__S9MIc"};function h(){return(0,u.jsxs)("div",{className:d.addWordPage,children:[(0,u.jsx)("h2",{className:d.title,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e"}),(0,u.jsx)("div",{className:d.formWrapper,children:(0,u.jsx)(c,{})})]})}},9766:(t,e,s)=>{s.d(e,{I0:()=>l,KW:()=>o,Kk:()=>a,ob:()=>u,qi:()=>c});var r=s(6213);const n="https://itgirlschool.justmakeit.ru/api",i="addedWords",a="deletedWords";async function o(t){const e=await function(t){return r.A.post(`${n}/words`,t).then((t=>t.data))}(t),s={id:"number"===typeof e.id?e.id:`local-${Date.now()}`,english:t.english,transcription:t.transcription,russian:t.russian,tags:t.tags},a=JSON.parse(localStorage.getItem(i)||"[]");return localStorage.setItem(i,JSON.stringify([...a,s])),s}async function u(t){const e=await function(t){return r.A.put(`${n}/words/${t.id}`,t).then((t=>t.data))}(t),s="number"===typeof e.id?e.id:t.id,a={id:s,english:t.english,transcription:t.transcription,russian:t.russian,tags:t.tags},o=JSON.parse(localStorage.getItem(i)||"[]").filter((t=>String(t.id)!==String(s)));return localStorage.setItem(i,JSON.stringify([...o,a])),a}async function l(t){String(t).startsWith("local-")||await function(t){return r.A.delete(`${n}/words/${t}`)}(t);const e=JSON.parse(localStorage.getItem(i)||"[]").filter((e=>String(e.id)!==String(t)));localStorage.setItem(i,JSON.stringify(e));const s=JSON.parse(localStorage.getItem(a)||"[]");return s.includes(String(t))||(s.push(String(t)),localStorage.setItem(a,JSON.stringify(s))),t}async function c(){const t=await r.A.get(`${n}/words`).then((t=>t.data)),e=JSON.parse(localStorage.getItem(a)||"[]"),s=JSON.parse(localStorage.getItem(i)||"[]"),o=t.filter((t=>!e.includes(String(t.id))));return[...o.map((t=>s.find((e=>String(e.id)===String(t.id)))||t)),...s.filter((t=>!o.find((e=>String(e.id)===String(t.id)))))]}}}]);
//# sourceMappingURL=241.4775a315.chunk.js.map