"use strict";(self.webpackChunkenglish_flashcards=self.webpackChunkenglish_flashcards||[]).push([[241],{2836:(t,e,s)=>{s.d(e,{n:()=>h});var r=s(5043),i=s(8664),n=s(116),a=s(9939),o=s(2078);class u extends o.Q{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=this.client.defaultMutationOptions(t),(0,i.f8)(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(e=this.currentMutation)||e.setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(null==(t=this.currentMutation)||t.removeObserver(this))}onMutationUpdate(t){this.updateResult();const e={listeners:!0};"success"===t.type?e.onSuccess=!0:"error"===t.type&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:"undefined"!==typeof t?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:(0,n.$)(),e={...t,isLoading:"loading"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){a.j.batch((()=>{var e,s,r,i;if(this.mutateOptions&&this.hasListeners())if(t.onSuccess)null==(e=(s=this.mutateOptions).onSuccess)||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(r=(i=this.mutateOptions).onSettled)||r.call(i,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(t.onError){var n,a,o,u;null==(n=(a=this.mutateOptions).onError)||n.call(a,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(o=(u=this.mutateOptions).onSettled)||o.call(u,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}t.listeners&&this.listeners.forEach((t=>{let{listener:e}=t;e(this.currentResult)}))}))}}var l=s(8873),c=s(9781),d=s(4084);function h(t,e,s){const n=(0,i.GR)(t,e,s),o=(0,c.jE)({context:n.context}),[h]=r.useState((()=>new u(o,n)));r.useEffect((()=>{h.setOptions(n)}),[h,n]);const g=(0,l.r)(r.useCallback((t=>h.subscribe(a.j.batchCalls(t))),[h]),(()=>h.getCurrentResult()),(()=>h.getCurrentResult())),m=r.useCallback(((t,e)=>{h.mutate(t,e).catch(p)}),[h]);if(g.error&&(0,d.G)(h.options.useErrorBoundary,[g.error]))throw g.error;return{...g,mutate:m,mutateAsync:g.mutate}}function p(){}},5241:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var r=s(5043),i=s(9781),n=s(2836),a=s(9766);const o={form:"AddWordForm_form__3YoZc",field:"AddWordForm_field__CR9-8",input:"AddWordForm_input__GQ-nM",button:"AddWordForm_button__eQWs4",success:"AddWordForm_success__oroQ-",error:"AddWordForm_error__5DqMM"};var u=s(579);const l=[{name:"english",label:"\u0421\u043b\u043e\u0432\u043e (\u0430\u043d\u0433\u043b.)",required:!0},{name:"transcription",label:"\u0422\u0440\u0430\u043d\u0441\u043a\u0440\u0438\u043f\u0446\u0438\u044f"},{name:"russian",label:"\u041f\u0435\u0440\u0435\u0432\u043e\u0434",required:!0},{name:"tags",label:"\u0422\u0435\u043c\u0430"}];function c(){const t=(0,i.jE)(),[e,s,c]=function(t){const[e,s]=(0,r.useState)(t);return[e,t=>{const{name:e,value:r}=t.target;s((t=>({...t,[e]:r})))},()=>s(t)]}({english:"",transcription:"",russian:"",tags:""}),[d,h]=r.useState(!1),[p,g]=r.useState(""),m=(0,n.n)(a.KW,{onSuccess:()=>{t.invalidateQueries(["words"]),h(!0),g(""),c()},onError:()=>{g("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0441\u043b\u043e\u0432\u043e"),h(!1)}});return(0,u.jsxs)("form",{onSubmit:t=>{t.preventDefault(),h(!1),g(""),m.mutate(e)},className:o.form,children:[l.map((t=>{let{name:r,label:i,required:n}=t;return(0,u.jsxs)("label",{className:o.field,children:[i,":",(0,u.jsx)("input",{name:r,value:e[r],onChange:s,required:n,className:o.input})]},r)})),(0,u.jsx)("button",{type:"submit",disabled:m.isLoading,className:o.button,children:m.isLoading?"\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u2026":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),d&&(0,u.jsx)("p",{className:o.success,children:"\u2705 \u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e!"}),p&&(0,u.jsxs)("p",{className:o.error,children:["\u274c ",p]})]})}const d={addWordPage:"AddWordPage_addWordPage__WFs9K",title:"AddWordPage_title__JXZ2w",formWrapper:"AddWordPage_formWrapper__S9MIc"};function h(){return(0,u.jsxs)("div",{className:d.addWordPage,children:[(0,u.jsx)("h2",{className:d.title,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0435 \u0441\u043b\u043e\u0432\u043e"}),(0,u.jsx)("div",{className:d.formWrapper,children:(0,u.jsx)(c,{})})]})}},9766:(t,e,s)=>{s.d(e,{I0:()=>l,KW:()=>o,Kk:()=>a,ob:()=>u,qi:()=>c});var r=s(6213);const i="https://itgirlschool.justmakeit.ru/api",n="addedWords",a="deletedWords";async function o(t){const e=await function(t){return r.A.post(`${i}/words`,t).then((t=>t.data))}(t),s={id:"number"===typeof e.id?e.id:`local-${Date.now()}`,english:t.english,transcription:t.transcription,russian:t.russian,tags:t.tags},a=JSON.parse(localStorage.getItem(n)||"[]");return localStorage.setItem(n,JSON.stringify([...a,s])),s}async function u(t){const e=await function(t){return r.A.put(`${i}/words/${t.id}`,t).then((t=>t.data))}(t),s="number"===typeof e.id?e.id:t.id,a={id:s,english:t.english,transcription:t.transcription,russian:t.russian,tags:t.tags},o=JSON.parse(localStorage.getItem(n)||"[]").filter((t=>String(t.id)!==String(s)));return localStorage.setItem(n,JSON.stringify([...o,a])),a}async function l(t){String(t).startsWith("local-")||await function(t){return r.A.delete(`${i}/words/${t}`)}(t);const e=JSON.parse(localStorage.getItem(n)||"[]").filter((e=>String(e.id)!==String(t)));localStorage.setItem(n,JSON.stringify(e));const s=JSON.parse(localStorage.getItem(a)||"[]");return s.includes(String(t))||(s.push(String(t)),localStorage.setItem(a,JSON.stringify(s))),t}async function c(){const t=await r.A.get(`${i}/words`).then((t=>t.data)),e=JSON.parse(localStorage.getItem(a)||"[]"),s=JSON.parse(localStorage.getItem(n)||"[]"),o=t.filter((t=>!e.includes(String(t.id))));return[...o.map((t=>s.find((e=>String(e.id)===String(t.id)))||t)),...s.filter((t=>!o.find((e=>String(e.id)===String(t.id)))))]}}}]);
//# sourceMappingURL=241.115bfb14.chunk.js.map